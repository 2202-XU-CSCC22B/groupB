{"ast":null,"code":"import axinst from '@/../server/axios-config.js';\nimport fieldNames from '@/../server/fieldNames.js';\nimport UploadButton from './UploadButton';\nexport default {\n  name: 'PassApproval',\n  components: {\n    UploadButton\n  },\n  data() {\n    return {\n      passes: [],\n      currentDate: ''\n    };\n  },\n  methods: {\n    async uploadFile(event, passId) {\n      try {\n        const file = event.target.files[0];\n        const formData = new FormData();\n        formData.append('file', file);\n        await axios.post(`/file/upload/${passId}`, formData);\n        console.log('File uploaded successfully');\n        // Add any additional logic or UI updates here\n      } catch (error) {\n        console.error('Error uploading file:', error);\n        // Handle error and show error message in the UI\n      }\n    },\n\n    formatDate(date) {\n      return new Date(date).toLocaleDateString('en-US', {\n        month: 'long',\n        day: 'numeric',\n        year: 'numeric',\n        hour: 'numeric',\n        minute: 'numeric'\n      });\n    },\n    checkApproval(pass) {\n      axinst.get(`/passes/check_approval/${pass._id}`).then(response => {\n        if (response.data.message === 'approved') {\n          pass.approvalStatus = response.data.message;\n          pass.unapprovedItems = [];\n        } else if (response.data.message === 'unapproved') {\n          pass.approvalStatus = response.data.message;\n          pass.unapprovedItems = response.data.unapprovedItems;\n        } else {\n          pass.approvalStatus = 'Error in retrieving pass data!';\n          pass.unapprovedItems = [];\n        }\n      }).catch(error => {\n        console.log(error);\n        pass.approvalStatus = '';\n        pass.unapprovedItems = [];\n      });\n    },\n    getAllPasses() {\n      axinst.get('/passes').then(response => {\n        this.passes = response.data;\n        this.passes.forEach(pass => {\n          this.checkApproval(pass);\n        });\n        this.passes.sort((a, b) => new Date(b.created) - new Date(a.created));\n      }).catch(error => {\n        console.log(error);\n      });\n    },\n    setCurrentDate() {\n      // Get the current date\n      var currentDate = new Date();\n\n      // Format the date\n      var options = {\n        weekday: 'long',\n        year: 'numeric',\n        month: 'long',\n        day: 'numeric'\n      };\n      this.currentDate = currentDate.toLocaleDateString(undefined, options);\n    }\n  },\n  created() {\n    this.getAllPasses();\n  },\n  computed: {\n    fieldNames() {\n      return fieldNames;\n    }\n  },\n  mounted() {\n    this.setCurrentDate();\n  }\n};","map":{"version":3,"names":["axinst","fieldNames","UploadButton","name","components","data","passes","currentDate","methods","uploadFile","event","passId","file","target","files","formData","FormData","append","axios","post","console","log","error","formatDate","date","Date","toLocaleDateString","month","day","year","hour","minute","checkApproval","pass","get","_id","then","response","message","approvalStatus","unapprovedItems","catch","getAllPasses","forEach","sort","a","b","created","setCurrentDate","options","weekday","undefined","computed","mounted"],"sources":["/home/vagrant/sites/ppc/src/home/PassApproval.vue"],"sourcesContent":["<template>\n  <div>\n    <div style=\"display: flex; flex-direction: row;\" v-for=\"pass in passes\" :key=\"pass._id\">\n      <div class='box'>\n        <div class=\"header\">\n          <div id=\"id\">{{ pass._id }}</div>\n          <div class=\"date\">{{ formatDate(pass.created) }}</div>\n        </div>\n\n        <div class=\"header\" style=\"margin-bottom: 8px\">\n          <div id=\"requestor\">Requested by <strong>{{ pass.req.name }}</strong></div>\n        </div>\n        \n        <div style=\"font-size: 18px; font-weight: bold; text-align: center; margin: 15px 0 5px 0; text-transform: uppercase;\"> {{ fieldNames[pass.nature.type] }} </div>\n        <div style=\"display: flex; flex-direction: row; flex-wrap: wrap; justify-content: space-around;\">\n          <div v-for=\"(entry, key) in pass.nature\" :key=\"key\">\n              <div class=\"entry\">\n                <div id=\"top\">\n                  {{ fieldNames[entry] || entry }}\n                </div>\n                <div id=\"bottom\">\n                  {{ fieldNames[key] || key }} \n              </div>\n            </div>\n          </div>\n        </div>\n\n        <div v-if=\"pass.showAllItems\">\n          <div class=\"item_wrap\">\n            <div class=\"wrap_box\" v-for=\"(entry, key) in pass.ptcs\" :key=\"key\">\n              <div v-for=\"(value, prop) in entry\" :key=\"prop\">\n                <div v-if=\"prop !== '_id' && prop !== 'tag' \">\n                  <strong>{{ fieldNames[prop] || prop }}</strong>: {{ fieldNames[value] || value }} \n                </div>\n              </div>\n            </div>\n          </div>\n        </div>\n       \n        <div :class=\"['status', { 'success': pass.approvalStatus, 'error': pass.unapprovedItems.length > 0 }]\">\n          <div v-if=\"pass.approvalStatus == 'approved'\">\n            <div id=\"label\">{{ pass.approvalStatus }}</div>\n          </div>\n          \n          <div v-else-if=\"pass.approvalStatus == 'unapproved'\">\n            <div id=\"label\">{{ pass.approvalStatus }}</div>\n          </div>\n        </div>\n\n        <div v-if=\"pass.showAllItems && pass.unapprovedItems.length > 0\" id=\"item\">\n          <span v-html=\"pass.unapprovedItems.join('<br>')\"></span>\n        </div>\n      </div>\n      <div class=\"p_wrap\">\n        <div class=\"square_btn\" @click=\"pass.showAllItems = !pass.showAllItems\">\n            <img style=\"height: 18px; width: 18px;\" v-if=\"!pass.showAllItems\" src=\"../assets/plus.png\">\n            <img style=\"height: 18px; width: 18px;\" v-else src=\"../assets/minus.png\">\n        </div>\n\n        <div v-if=\"pass.approvalStatus == 'unapproved'\">\n          <UploadButton/>\n        </div>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script>\nimport axinst from '@/../server/axios-config.js';\nimport fieldNames from '@/../server/fieldNames.js';\nimport UploadButton from './UploadButton';\n\nexport default {\n  name: 'PassApproval',\n  components: {\n    UploadButton\n  },\n\n  data() {\n    return {\n      passes: [],\n      currentDate: ''\n    };\n  },\n  methods: {\n    async uploadFile(event, passId) {\n    try {\n      const file = event.target.files[0];\n      const formData = new FormData();\n      formData.append('file', file);\n\n      await axios.post(`/file/upload/${passId}`, formData);\n\n      console.log('File uploaded successfully');\n      // Add any additional logic or UI updates here\n    } catch (error) {\n      console.error('Error uploading file:', error);\n      // Handle error and show error message in the UI\n    }\n  },\n\n    formatDate(date) {\n      return new Date(date).toLocaleDateString('en-US', {\n        month: 'long',\n        day: 'numeric',\n        year: 'numeric',\n        hour: 'numeric',\n        minute: 'numeric'\n      })\n    },\n\n    checkApproval(pass) {\n      axinst.get(`/passes/check_approval/${pass._id}`)\n        .then(response => {\n          if (response.data.message === 'approved') {\n            pass.approvalStatus = response.data.message;\n            pass.unapprovedItems = [];\n          } else if (response.data.message === 'unapproved') {\n            pass.approvalStatus = response.data.message;\n            pass.unapprovedItems = response.data.unapprovedItems;\n          } else {\n            pass.approvalStatus = 'Error in retrieving pass data!';\n            pass.unapprovedItems = [];\n          }\n        })\n        .catch(error => {\n          console.log(error);\n          pass.approvalStatus = '';\n          pass.unapprovedItems = [];\n        });\n    },\n    \n    getAllPasses() {\n      axinst.get('/passes')\n        .then(response => {\n          this.passes = response.data;\n          this.passes.forEach(pass => {\n            this.checkApproval(pass);\n          });\n\n          this.passes.sort((a, b) => new Date(b.created) - new Date(a.created));\n        })\n        .catch(error => {\n          console.log(error);\n        });\n    },\n\n    setCurrentDate() {\n      // Get the current date\n      var currentDate = new Date();\n\n      // Format the date\n      var options = { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' };\n      this.currentDate = currentDate.toLocaleDateString(undefined, options);\n    }\n  },\n  created() {\n    this.getAllPasses();\n  },\n  \n  computed: {\n    fieldNames() {\n      return fieldNames;\n    }\n  },\n\n  mounted() {\n    this.setCurrentDate();\n  }\n}\n</script>\n\n<style scoped>\n.entry{\n  margin: 6px 5px;\n  text-align: center;\n  flex-grow: 1;\n}\n.entry #top{\n  font-size: 15px;\n  font-weight: bold;\n}\n.entry #bottom{\n  font-size: 12px;\n  text-transform: uppercase;\n  color: #6d6d75;\n}\n.p_wrap{\n  margin-top: 30px;\n  padding: 0 14px;\n  display: flex;\n  flex-direction: column;\n  justify-content: center;\n}\n.p_wrap * {\n  margin: 4px;\n}\n\n.item_wrap {\n  display: flex;\n  flex-wrap: wrap;\n  justify-content: space-between;\n  margin: 20px 0 0 0;\n}\n\n.wrap_box {\n  font-size: 15px;\n  border-radius: 6px;\n  flex-grow: 1;\n  margin: 0 5px 10px 5px;\n  padding: 12px;\n  background-color: #e7e9f0;\n}\n\n.wrap_box:first-child {\n  margin: 0 5px 10px 0 !important;\n}\n\n.wrap_box:last-child {\n  margin: 0 0 10px 5px  !important;\n}\n\n.wrap_box:only-child{\n  margin: 0;\n}\n\n.wrap_box:nth-child(n+3) {\n  margin-left: 0 !important;\n}\n\n#details{\n  background-color: #dbdce2;\n  border: 0;\n  color: var(--tColor2);\n  border-radius: 8px;\n  box-sizing: border-box;\n  font-family: var(--text);\n  font-size: 15px;\n  padding: 6px 12px;\n  text-transform: uppercase;\n  transition: 0.2s;\n}\n\n#details:hover{\n  background-color: #b9bac9;\n  color: #fff;\n  cursor: pointer;\n}\n\n.header{\n  align-items: center;\n  display: flex;\n  justify-content: space-between;\n  width: auto;\n}\n.date{\n  font-weight: bold;\n}\n\n#item{\n  color: #7a1d26;\n  margin-top: 20px;\n  text-align: center;\n}\n\n#label {\n  font-size: 18px;\n  font-weight: bold;\n  text-align: center;\n  text-transform: uppercase;\n}\n\n#id {\n  font-size: 20px;\n  font-weight: bold;\n}\n\n#requestor{\n  font-size: 14px;\n  text-transform: uppercase;\n  color: #6d6d75;\n}\n.status.success {\n  background-color: #6bca49;\n  color: #ffffff;\n}\n\n.status.error {\n  background-color: #fae3e3;\n  border: 1px solid #d41b2a;\n  color: #d41b2a;\n}\n\n.status{\n  border-radius: 6px;\n  padding: 7px 0;\n  width: auto;\n  margin-top: 25px;\n}\n\n.box {\n  border-radius: 8px;\n  border: var(--borGrey);\n  box-sizing: border-box;\n  height: auto;\n  margin-top: 30px;\n  padding: 20px;\n  text-align: left;\n  width: 600px;\n}\n</style>\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}